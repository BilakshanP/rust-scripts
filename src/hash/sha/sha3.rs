#![allow(dead_code)]

use super::super::keccak::keccak;

pub fn shake_128(input_bytes: &[u128], output_byte_len: u128) -> Vec<u128> {
    keccak(1344, 256, input_bytes, 0x1F, output_byte_len)
}

pub fn shake_256(input_bytes: &[u128], output_byte_len: u128) -> Vec<u128> {
    keccak(1088, 512, input_bytes, 0x1F, output_byte_len)
}

pub fn sha3_224(input_bytes: &[u128]) -> Vec<u128> {
    keccak(1152, 448, input_bytes, 0x06, 224 / 8)
}

pub fn sha3_256(input_bytes: &[u128]) -> Vec<u128> {
    keccak(1088, 512, input_bytes, 0x06, 256 / 8)
}

pub fn sha3_384(input_bytes: &[u128]) -> Vec<u128> {
    keccak(832, 768, input_bytes, 0x06, 384 / 8)
}

pub fn sha3_512(input_bytes: &[u128]) -> Vec<u128> {
    keccak(576, 1024, input_bytes, 0x06, 512 / 8)
}

#[cfg(test)]
pub mod sha3_test {
    #[test]
    fn shake_128() {
        assert_eq!(super::shake_128(&[], 0), []);
        assert_eq!(super::shake_128(&[0, 0, 0, 0, 0, 0, 0, 0], 8), [122, 36, 182, 102, 218, 52, 92, 152]);
        assert_eq!(super::shake_128(&[1, 2, 3, 4, 5, 6, 7, 8], 16), [23, 6, 165, 230, 79, 122, 252, 183, 99, 133, 172, 100, 57, 77, 71, 121]);
        assert_eq!(super::shake_128(&[255, 255, 255, 255, 255, 255, 255, 255], 24), [154, 237, 227, 59, 193, 250, 121, 146, 221, 79, 168, 56, 33, 42, 115, 83, 186, 170, 85, 19, 187, 74, 226, 89]);
    }
    
    #[test]
    fn shake_256() {
        assert_eq!(super::shake_256(&[], 0), []);
        assert_eq!(super::shake_256(&[0, 0, 0, 0, 0, 0, 0, 0], 8), [17, 145, 65, 220, 232, 152, 7, 9]);
        assert_eq!(super::shake_256(&[1, 2, 3, 4, 5, 6, 7, 8], 16), [143, 217, 102, 163, 139, 185, 52, 218, 229, 61, 52, 228, 32, 59, 158, 93]);
        assert_eq!(super::shake_256(&[255, 255, 255, 255, 255, 255, 255, 255], 24), [146, 178, 173, 247, 12, 9, 76, 136, 104, 227, 24, 23, 74, 69, 13, 89, 138, 224, 247, 56, 97, 21, 70, 161]);
    }
    
    #[test]
    fn sha3_224() {
        assert_eq!(super::sha3_224(&[]), [107, 78, 3, 66, 54, 103, 219, 183, 59, 110, 21, 69, 79, 14, 177, 171, 212, 89, 127, 154, 27, 7, 142, 63, 91, 90, 107, 199]);
        assert_eq!(super::sha3_224(&[0, 0, 0, 0, 0, 0, 0, 0]), [6, 90, 74, 53, 229, 119, 18, 172, 51, 246, 200, 1, 182, 233, 151, 3, 232, 243, 74, 14, 187, 211, 126, 146, 123, 239, 211, 4]);
        assert_eq!(super::sha3_224(&[1, 2, 3, 4, 5, 6, 7, 8]), [27, 71, 64, 246, 178, 206, 49, 149, 200, 112, 249, 106, 68, 57, 169, 40, 29, 66, 18, 77, 35, 115, 156, 44, 103, 65, 123, 121]);
        assert_eq!(super::sha3_224(&[255, 255, 255, 255, 255, 255, 255, 255]), [75, 175, 125, 103, 220, 133, 92, 233, 231, 130, 118, 78, 95, 212, 72, 251, 158, 153, 128, 8, 207, 125, 167, 186, 38, 154, 49, 76]);
    }
    
    #[test]
    fn sha3_256() {
        assert_eq!(super::sha3_256(&[]), [167, 255, 198, 248, 191, 30, 215, 102, 81, 193, 71, 86, 160, 97, 214, 98, 245, 128, 255, 77, 228, 59, 73, 250, 130, 216, 10, 75, 128, 248, 67, 74]);
        assert_eq!(super::sha3_256(&[0, 0, 0, 0, 0, 0, 0, 0]), [72, 221, 165, 187, 233, 23, 26, 102, 86, 32, 110, 197, 108, 89, 92, 88, 52, 182, 207, 56, 197, 254, 113, 188, 180, 79, 228, 56, 51, 174, 233, 223]);
        assert_eq!(super::sha3_256(&[1, 2, 3, 4, 5, 6, 7, 8]), [201, 255, 184, 249, 215, 235, 193, 173, 188, 188, 49, 108, 254, 224, 52, 203, 161, 88, 183, 198, 201, 60, 52, 100, 42, 11, 132, 41, 102, 106, 61, 16]);
        assert_eq!(super::sha3_256(&[255, 255, 255, 255, 255, 255, 255, 255]), [218, 185, 186, 214, 121, 172, 105, 170, 183, 113, 117, 40, 132, 47, 184, 103, 102, 58, 250, 109, 72, 34, 209, 89, 207, 206, 219, 229, 182, 129, 158, 185]);
    }
    
    #[test]
    fn sha3_384() {
        assert_eq!(super::sha3_384(&[]), [12, 99, 167, 91, 132, 94, 79, 125, 1, 16, 125, 133, 46, 76, 36, 133, 197, 26, 80, 170, 170, 148, 252, 97, 153, 94, 113, 187, 238, 152, 58, 42, 195, 113, 56, 49, 38, 74, 219, 71, 251, 107, 209, 224, 88, 213, 240, 4]);
        assert_eq!(super::sha3_384(&[0, 0, 0, 0, 0, 0, 0, 0]), [25, 95, 213, 137, 182, 8, 55, 97, 68, 60, 169, 17, 237, 185, 55, 165, 107, 29, 53, 3, 179, 178, 181, 79, 225, 116, 62, 83, 73, 128, 26, 129, 30, 75, 213, 233, 151, 81, 115, 207, 195, 185, 250, 69, 156, 229, 197, 179]);
        assert_eq!(super::sha3_384(&[1, 2, 3, 4, 5, 6, 7, 8]), [182, 47, 220, 166, 102, 175, 231, 162, 193, 119, 17, 154, 188, 114, 59, 43, 33, 59, 208, 183, 31, 117, 225, 98, 228, 118, 167, 80, 103, 180, 159, 67, 254, 211, 149, 93, 38, 63, 159, 76, 214, 238, 201, 51, 217, 92, 97, 232]);
        assert_eq!(super::sha3_384(&[255, 255, 255, 255, 255, 255, 255, 255]), [77, 106, 86, 6, 165, 155, 19, 68, 107, 177, 75, 85, 108, 87, 191, 165, 112, 72, 46, 66, 91, 27, 161, 73, 232, 104, 145, 147, 123, 58, 146, 181, 153, 116, 198, 162, 92, 49, 242, 113, 219, 89, 99, 95, 103, 80, 147, 116]);
    }
    
    #[test]
    fn sha3_512() {
        assert_eq!(super::sha3_512(&[]), [166, 159, 115, 204, 162, 58, 154, 197, 200, 181, 103, 220, 24, 90, 117, 110, 151, 201, 130, 22, 79, 226, 88, 89, 224, 209, 220, 193, 71, 92, 128, 166, 21, 178, 18, 58, 241, 245, 249, 76, 17, 227, 233, 64, 44, 58, 197, 88, 245, 0, 25, 157, 149, 182, 211, 227, 1, 117, 133, 134, 40, 29, 205, 38]);
        assert_eq!(super::sha3_512(&[0, 0, 0, 0, 0, 0, 0, 0]), [10, 222, 29, 185, 204, 133, 82, 237, 89, 151, 165, 100, 45, 131, 94, 189, 25, 19, 103, 208, 140, 36, 86, 74, 115, 90, 22, 247, 119, 236, 122, 15, 2, 231, 87, 94, 92, 119, 142, 57, 214, 205, 250, 121, 0, 108, 217, 107, 196, 180, 9, 103, 171, 188, 35, 185, 16, 158, 237, 47, 41, 106, 248, 246]);
        assert_eq!(super::sha3_512(&[1, 2, 3, 4, 5, 6, 7, 8]), [34, 196, 223, 57, 76, 99, 97, 105, 93, 42, 70, 232, 110, 149, 176, 228, 232, 163, 140, 214, 255, 115, 64, 25, 228, 189, 221, 189, 34, 104, 87, 28, 248, 164, 26, 124, 20, 242, 186, 80, 137, 244, 104, 193, 44, 139, 100, 221, 141, 52, 174, 108, 193, 42, 124, 137, 233, 223, 166, 127, 28, 134, 7, 94]);
        assert_eq!(super::sha3_512(&[255, 255, 255, 255, 255, 255, 255, 255]), [105, 214, 82, 18, 75, 218, 10, 243, 4, 104, 133, 79, 212, 199, 57, 20, 47, 45, 51, 6, 80, 3, 167, 228, 219, 181, 230, 46, 39, 218, 117, 241, 182, 130, 197, 1, 12, 206, 241, 193, 101, 158, 236, 91, 35, 102, 233, 57, 172, 165, 33, 246, 134, 139, 59, 219, 104, 231, 232, 46, 39, 126, 24, 155]);
    }
}